{% extends 'shop/base.html' %}
{% include 'navbar.html' %}

{% block content %}
<section id="receipt" style="max-width:800px; margin:50px auto; padding:30px; background:#f9f9f9; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.1); font-family:sans-serif;">

  <h1 style="text-align:center; color:#333; margin-bottom:20px;">üìÑ Receipt</h1>

  <div style="margin-bottom:20px; color:#555; font-size:15px;">
    <p><strong>Order ID:</strong> {{ order.id }}</p>
    <p><strong>Date:</strong> {{ order.created_at }}</p>
    <p><strong>Customer:</strong> {{ order.user.username }}</p>
  </div>

  <hr style="border:none; border-top:1px solid #ddd; margin-bottom:20px;">

  <table style="width:100%; border-collapse:collapse; font-size:14px;">
    <thead>
      <tr style="background:#f04e30; color:#fff; text-align:left;">
        <th style="padding:10px; border-bottom:2px solid #ddd;">Product</th>
        <th style="padding:10px; border-bottom:2px solid #ddd;">Qty</th>
        <th style="padding:10px; border-bottom:2px solid #ddd;">Price</th>
      </tr>
    </thead>
    <tbody>
      {% for item in order.items.all %}
      <tr style="border-bottom:1px solid #eee;">
        <td style="padding:10px;">{{ item.product.name }}</td>
        <td style="padding:10px;">{{ item.quantity }}</td>
        <td style="padding:10px;">‚Çπ{{ item.price|floatformat:2 }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <p style="text-align:right; font-size:16px; font-weight:bold; margin-top:20px; color:#28a745;">
    Total Paid: ‚Çπ{{ order.total }}
  </p>
</section>

<!-- ‚úÖ Button Section -->
<div style="text-align:center; margin-top:30px;">
    <button onclick="printReceipt()" 
            style="background:#28a745; color:#fff; padding:10px 20px; border:none; border-radius:6px; font-weight:600; cursor:pointer; font-size:14px; margin-right:10px;">
      üñ® Print Receipt
    </button>

    <a href="{% url 'product_list' %}" 
       style="display:inline-block; background:#007bff; color:#fff; padding:10px 20px; border-radius:6px; text-decoration:none; font-weight:600; font-size:14px;">
      ‚¨ÖÔ∏è Back to Products
    </a>
</div>

<script>
function printReceipt() {
    // Get the receipt HTML
    var receiptContent = document.getElementById('receipt').innerHTML;

    // Open a new window
    var printWindow = window.open('', '', 'height=600,width=800');

    // Write the receipt content to the new window
    printWindow.document.write('<html><head><title>Receipt</title>');
    printWindow.document.write('<style>table {width:100%; border-collapse:collapse; font-size:14px;} th, td {padding:10px; border:1px solid #ddd;} th {background:#f04e30; color:#fff;} h1,p {margin:0 0 10px 0;}</style>');
    printWindow.document.write('</head><body>');
    printWindow.document.write(receiptContent);
    printWindow.document.write('</body></html>');

    // Print the content
    printWindow.document.close();
    printWindow.focus();
    printWindow.print();
    printWindow.close();
}
</script>

{% endblock %}
